The 'subscribeToUsers' function in 'src/services/users.ts' has been optimized to accept an array of filter queries (UserQueryFilters[]). When multiple queries are provided, it sets up multiple concurrent Firestore listeners and merges the results into a single list, deduplicating by ID. This allows for complex filtering scenarios (e.g., fetching only classmates + staff) without downloading the entire users collection.
In 'src/context/DataContext.tsx', role-based subscriptions are implemented for students to optimize data fetching. Students now only subscribe to their classmates (via classId filter) and staff (via role filter), significantly reducing the initial data load compared to fetching all users.
